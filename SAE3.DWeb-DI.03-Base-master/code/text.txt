Itération 3
Select Count From Sales where (date);
SELECT SUM(amount) AS total_sales
FROM Sales
WHERE MONTH(date) = 12
AND YEAR(date) = YEAR(CURRENT_DATE());

Itération 4
(
    SELECT Movies.*, COUNT(Sales.id) as count, 'purchase' as type
    FROM Sales
    JOIN Movies ON Sales.movie_id = Movies.id
    WHERE MONTH(Sales.purchase_date) = MONTH(CURRENT_DATE() - INTERVAL 1 MONTH)
    AND YEAR(Sales.purchase_date) = YEAR(CURRENT_DATE() - INTERVAL 1 MONTH)
    GROUP BY Movies.id
    ORDER BY count DESC
    LIMIT 3
)
UNION ALL
(
    SELECT Movies.*, COUNT(Rentals.id) as count, 'rental' as type
    FROM Rentals
    JOIN Movies ON Rentals.movie_id = Movies.id
    WHERE MONTH(Rentals.rental_date) = MONTH(CURRENT_DATE() - INTERVAL 1 MONTH)
    AND YEAR(Rentals.rental_date) = YEAR(CURRENT_DATE() - INTERVAL 1 MONTH)
    GROUP BY Movies.id
    ORDER BY count DESC
    LIMIT 3
)